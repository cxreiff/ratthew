use bevy::prelude::*;

use crate::blocks::BlockMesh;

#[derive(Clone, Debug)]
pub struct RampMesh;

#[derive(Resource, Deref, Clone, Debug)]
pub struct RampMeshHandle(Handle<Mesh>);

impl From<Handle<Mesh>> for RampMeshHandle {
    fn from(value: Handle<Mesh>) -> Self {
        Self(value)
    }
}

impl BlockMesh for RampMesh {
    type Handle = RampMeshHandle;

    fn indices() -> Vec<u32> {
        vec![
            0, 1, 3, 1, 2, 3, // down (-y)
            4, 6, 5, // east (+x)
            7, 8, 9, // west (-x)
            10, 13, 11, 11, 13, 12, // up/south (+y, +z)
            14, 15, 17, 15, 16, 17, // north (-z)
        ]
    }

    fn positions() -> Vec<[f32; 3]> {
        vec![
            // down (-y)
            [-0.5, -0.5, -0.5],
            [0.5, -0.5, -0.5],
            [0.5, -0.5, 0.5],
            [-0.5, -0.5, 0.5],
            // east (+x)
            [0.5, -0.5, -0.5],
            [0.5, -0.5, 0.5],
            [0.5, 0.5, -0.5],
            // west (-x)
            [-0.5, -0.5, -0.5],
            [-0.5, -0.5, 0.5],
            [-0.5, 0.5, -0.5],
            // up/south (+y, +z)
            [-0.5, -0.5, 0.5],
            [-0.5, 0.5, -0.5],
            [0.5, 0.5, -0.5],
            [0.5, -0.5, 0.5],
            // north (-z)
            [-0.5, -0.5, -0.5],
            [-0.5, 0.5, -0.5],
            [0.5, 0.5, -0.5],
            [0.5, -0.5, -0.5],
        ]
    }

    fn uvs() -> Vec<[f32; 2]> {
        vec![
            // down (-y)
            [0.0, 0.0],
            [1.0, 0.0],
            [1.0, 1.0],
            [0.0, 1.0],
            // east (+x)
            [1.0, 1.0],
            [0.0, 1.0],
            [1.0, 0.0],
            // west (-x)
            [0.0, 1.0],
            [1.0, 1.0],
            [0.0, 0.0],
            // up/south (+y, +z)
            [0.0, 1.0],
            [0.0, 0.0],
            [1.0, 0.0],
            [1.0, 1.0],
            // north (-z)
            [1.0, 1.0],
            [1.0, 0.0],
            [0.0, 0.0],
            [0.0, 1.0],
        ]
    }

    fn normals() -> Vec<[f32; 3]> {
        vec![
            // down (-y)
            [0.0, -1.0, 0.0],
            [0.0, -1.0, 0.0],
            [0.0, -1.0, 0.0],
            [0.0, -1.0, 0.0],
            // east (+x)
            [1.0, 0.0, 0.0],
            [1.0, 0.0, 0.0],
            [1.0, 0.0, 0.0],
            // west (-x)
            [-1.0, 0.0, 0.0],
            [-1.0, 0.0, 0.0],
            [-1.0, 0.0, 0.0],
            // up/south (+y, +z)
            [0.0, 1.0, 1.0],
            [0.0, 1.0, 1.0],
            [0.0, 1.0, 1.0],
            [0.0, 1.0, 1.0],
            // north (-z)
            [0.0, 0.0, -1.0],
            [0.0, 0.0, -1.0],
            [0.0, 0.0, -1.0],
            [0.0, 0.0, -1.0],
        ]
    }
}
